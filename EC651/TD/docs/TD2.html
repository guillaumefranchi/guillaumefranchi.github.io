<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Guillaume Franchi">

<title>TD2 : Régression linéaire multiple – EC651 et 56/53 : Modélisation statistique (Régression linéaire)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-5d2e30ad26079c1dae90a1fd11eba2b9.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Pas de résultats",
    "search-matching-documents-text": "documents trouvés",
    "search-copy-link-title": "Copier le lien vers la recherche",
    "search-hide-matches-text": "Cacher les correspondances additionnelles",
    "search-more-match-text": "correspondance de plus dans ce document",
    "search-more-matches-text": "correspondances de plus dans ce document",
    "search-clear-button-title": "Effacer",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Annuler",
    "search-submit-button-title": "Envoyer",
    "search-label": "Recherche"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./TD2.html">TD2 : Régression linéaire multiple</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Recherche" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">EC651 et 56/53 : Modélisation statistique (Régression linéaire)</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Recherche"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Avant-Propos</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TD1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TD1 : Régression linéaire simple</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TD2.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">TD2 : Régression linéaire multiple</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./TD3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TD3 : Régression non linéaire</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Sur cette page</h2>
   
  <ul>
  <li><a href="#exercice-1" id="toc-exercice-1" class="nav-link active" data-scroll-target="#exercice-1">Exercice 1</a></li>
  <li><a href="#exercice-2" id="toc-exercice-2" class="nav-link" data-scroll-target="#exercice-2">Exercice 2</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">TD2 : Régression linéaire multiple</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Auteur·rice</div>
    <div class="quarto-title-meta-contents">
             <p>Guillaume Franchi </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="exercice-1" class="level1 unnumbered">
<h1 class="unnumbered">Exercice 1</h1>
<p>On considère un échantillon de 500 produits anti-âge disponible <a href="./cosmetics.csv" download=""> ici </a>.</p>
<p>Le jeu de données consiste en 6 variables :</p>
<ul>
<li><em>product_type</em>,</li>
<li><em>viscosity</em> en mPa.s,</li>
<li><em>pH</em>,</li>
<li><em>density</em> en g/cm<span class="math inline">\(^3\)</span>,</li>
<li><em>surface_tension</em> en mN/m,</li>
<li><em>user_rating</em>, correspondant à une note moyenne donnée par les consommateurs (entre 1 et 5).</li>
</ul>
<p>On cherche à expliquer la note donnée par les consommateurs en fonction des autres variables.</p>
<ol type="1">
<li>Importer les données dans R et effectuer un rapide résumé statistique.</li>
</ol>
<details>
<summary>
Voir le code
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>cosmetics <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"cosmetics.csv"</span>,<span class="at">row.names=</span><span class="dv">1</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>cosmetics <span class="ot">&lt;-</span> cosmetics <span class="sc">%&gt;%</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">product_type=</span><span class="fu">as.factor</span>(product_type)) <span class="co"># On met cette variable en facteur</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cosmetics)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> product_type   viscosity            pH           density       surface_tension
 cream :122   Min.   : 534.9   Min.   :4.620   Min.   :0.9180   Min.   :26.20  
 gel   :122   1st Qu.: 893.0   1st Qu.:5.515   1st Qu.:0.9577   1st Qu.:33.10  
 lotion:108   Median :1290.8   Median :5.900   Median :0.9950   Median :36.20  
 serum :148   Mean   :1711.8   Mean   :5.881   Mean   :0.9905   Mean   :37.30  
              3rd Qu.:1826.4   3rd Qu.:6.240   3rd Qu.:1.0180   3rd Qu.:41.23  
              Max.   :4104.0   Max.   :7.020   Max.   :1.0590   Max.   :53.30  
  user_rating   
 Min.   :2.490  
 1st Qu.:3.170  
 Median :3.415  
 Mean   :3.481  
 3rd Qu.:3.763  
 Max.   :4.760  </code></pre>
</div>
</div>
</details>
<ol start="2" type="1">
<li>Représenter graphiquement les liens pouvant exister entre la variable <em>user_rating</em> et les autres.</li>
</ol>
<details>
<summary>
Voir le code
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(cosmetics[,<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>])</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TD2_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</details>
<details class="mydetails">
<summary>
Commentaire
</summary>
Bien que les corrélations calculées entre les différentes variables soient significativement non nuls, les nuages de points ne montrent pas de tendance particulière, si ce n’est entre les variables <em>user_rating</em> et <em>surface_tension</em>. On remarque toutefois des clusters sur certains nuages de points, notamment pour la variable <em>viscosity</em>, montrant l’impact de la variable catégorielle <em>product_type</em>, indiquant si le produit est une crème, un gel, etc…
</details>
<ol start="3" type="1">
<li>Un modèle linéaire semble-t-il adapté pour prédire la note donnée par les consommateurs ? Ecrire mathématiquement ce modèle.</li>
</ol>
<details class="mydetails">
<summary>
Réponse
</summary>
<p>D’après la significativité des coefficients de corrélation, on peut penser qu’un modèle linéaire est adapté aux données. On fera toutefois attention au fait que les variables explicatives sont parfois fortement corrélées entre elles. Etant donné la présence d’une variable qualitative <em>(product_type)</em>, celui-ci s’écrit un peu différemment. On note :</p>
<ul>
<li><span class="math inline">\(Y\)</span> la variable réponse <em>user_rating</em>, (observations <span class="math inline">\(y_1,\ldots,y_n\)</span>);</li>
<li><span class="math inline">\(X_1\)</span> la variable <em>product_type</em>, (observations <span class="math inline">\(x_{1,1},\ldots,x_{n,1}\)</span>);</li>
<li><span class="math inline">\(X_2\)</span> la variable <em>viscosity</em>, (observations <span class="math inline">\(x_{1,2},\ldots,x_{n,2}\)</span>);</li>
<li><span class="math inline">\(X_3\)</span> la variable <em>pH</em>, (observations <span class="math inline">\(x_{1,3},\ldots,x_{n,3}\)</span>);</li>
<li><span class="math inline">\(X_4\)</span> la variable <em>density</em>, (observations <span class="math inline">\(x_{1,4},\ldots,x_{n,4}\)</span>);</li>
<li><span class="math inline">\(X_5\)</span> la variable <em>surface_tension</em>, (observations <span class="math inline">\(x_{1,5},\ldots,x_{n,5}\)</span>).</li>
</ul>
<p>On a alors pour tout <span class="math inline">\(i \in \{1,\ldots,n\}\)</span> <span class="math display">\[y_i = \beta_0 + \beta_1^{gel} \mathbf{1}_{gel}(x_{i,1}) + \beta_1^{lotion} \mathbf{1}_{lotion}(x_i,1) +\beta_1^{serum} \mathbf{1}_{serum}(x_{i,1}) + \beta_2 x_{i,2} + \beta_3 x_{i,3} +\beta_4 x_{i,4} + \beta_5 x_{i,5} + \varepsilon_i\]</span> où les <span class="math inline">\(\varepsilon_i\)</span> son i.i.d. de loi <span class="math inline">\(\mathcal{N}(0,\sigma^2)\)</span>.</p>
<strong><em>Remarque :</em></strong> Le modèle ne contient ici pas de coefficient <span class="math inline">\(\beta_1^{cream}\)</span> pour des raisons d’<strong>identifiabilité</strong>. En d’autres termes, si on intégrait ce coeffcient dans le modèle, différentes valeurs des coefficients aboutiraient aux mêmes valeurs réponses, ce qui poseraient un souci quant à la bonne définition du problème.
</details>
<ol start="4" type="1">
<li>Ajuster un modèle linéaire aux données, permettant d’expliquer <em>user_rating</em> en fonction des autres variables.</li>
</ol>
<details>
<summary>
Voir le code
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>lm_cosmetics <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>cosmetics,<span class="at">formula =</span> user_rating<span class="sc">~</span>.)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_cosmetics)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = user_rating ~ ., data = cosmetics)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.80811 -0.20967  0.01328  0.19511  0.93520 

Coefficients:
                     Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         3.037e+00  9.844e-01   3.085  0.00215 ** 
product_typegel     1.238e-01  1.965e-01   0.630  0.52905    
product_typelotion  4.285e-02  1.621e-01   0.264  0.79161    
product_typeserum   9.843e-02  2.168e-01   0.454  0.65001    
viscosity           2.848e-04  7.241e-05   3.933  9.6e-05 ***
pH                 -1.651e-01  6.498e-02  -2.542  0.01134 *  
density             6.947e-01  8.555e-01   0.812  0.41714    
surface_tension     4.606e-03  5.795e-03   0.795  0.42706    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2916 on 492 degrees of freedom
Multiple R-squared:  0.5926,    Adjusted R-squared:  0.5868 
F-statistic: 102.2 on 7 and 492 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</details>
<p>Quel est le pourcentage de variance expliquée par le modèle ?</p>
<p>Quelles variables ne semblent pas expliquer la note donnée par les consommateurs ?</p>
<details class="mydetails">
<summary>
Réponse
</summary>
<ul>
<li>Le coefficient <span class="math inline">\(R^2\)</span> calculé est de 0.5926. Le modèle explique donc 59,26% de la variance.</li>
<li>Les variables ayant un coefficient non significatif sont les suivantes :
<ul>
<li><em>product_type</em>;</li>
<li><em>density</em>;</li>
<li><em>surface_tension</em>.</li>
</ul></li>
</ul>
Elles ne semblent donc pas expliquer la note donnée par les consommateurs.
</details>
<ol start="5" type="1">
<li>À l’aide de la fonction <code>anova()</code>, réaliser un test de modèles emboîtés afin de déterminer les variables intervenant réellement dans le modèle. Ecrire les hypothèses envisagées dans ce test.</li>
</ol>
<details class="mydetails">
<summary>
Réponse
</summary>
<p>D’après le résumé statistique effectué précédemment, on envisage le test <span class="math display">\[ H_0 : \beta_1^{gel}=\beta_1^{lotion} = \beta_1^{serum}=\beta_4=\beta_5=0 \quad \text{contre} \quad H_1 : \text{l'un de ces coeffcients est non nul.} \]</span> On rappelle que la statistique de test utilisée ici est <span class="math display">\[ F = \dfrac{n-p}{q} \times \dfrac{SCR_0 - SCR}{SCR}, \]</span> qui suit une loi de Fisher <span class="math inline">\(\mathcal{F}_{n-p}^q\)</span> sous <span class="math inline">\(H_0\)</span>, où</p>
<ul>
<li><span class="math inline">\(p\)</span> est le nombre de paramètres à estimer dans le modèle complet;</li>
<li><span class="math inline">\(q\)</span> est la différence du nombre de paramètres à estimer entre le modèle complet et le modèle réduit;</li>
<li><span class="math inline">\(SCR\)</span> est la somme des carrés résiduelle dans le modèle complet;</li>
<li><span class="math inline">\(SCR_0\)</span> est la somme des carrés résiduelle dans le modèle réduit.</li>
</ul>
</details>
<details>
<summary>
Voir le code
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>lm_cosmetics_reduit <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>cosmetics,<span class="at">formula =</span> user_rating <span class="sc">~</span> product_type <span class="sc">+</span> viscosity <span class="sc">+</span> pH)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lm_cosmetics,lm_cosmetics_reduit)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: user_rating ~ product_type + viscosity + pH + density + surface_tension
Model 2: user_rating ~ product_type + viscosity + pH
  Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)
1    492 41.825                           
2    494 41.943 -2  -0.11823 0.6954 0.4994</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Avec une p-value de 0.4994, one ne rejette pas l'hypothèse nulle H0.</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<ol start="6" type="1">
<li>On souhaite maintenant comparer les performances prédictitives des deux modèles utilisés précédemment :</li>
</ol>
<ul>
<li>le modèle complet, avec toutes les variables;</li>
<li>le modèle réduit, comprenant uniquement les variables semblant expliquer la note donnée par les consommateurs.</li>
</ul>
<p>Pour ce faire, on dispose de 50 données supplémentaires <em>(disponibles</em> <a href="./cosmetics_extra.csv" download=""> ici </a>).</p>
<p>Prédire, avec les deux modèles, les notes données par les consommateurs pour ces 50 nouveaux produits.</p>
<details>
<summary>
Voir le code
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>cosmetics_extra <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"cosmetics_extra.csv"</span>,<span class="at">row.names=</span><span class="dv">1</span>)<span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">product_type=</span><span class="fu">as.factor</span>(product_type))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>pred_complet <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_cosmetics,<span class="at">newdata =</span> cosmetics_extra)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>pred_reduit <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_cosmetics_reduit, <span class="at">newdata =</span> cosmetics_extra)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<ol start="7" type="1">
<li>Calculer, pour chacune des prédictions, l’erreur quadratique moyenne <span class="math inline">\(MSE\)</span> réalisée par chaque modèle : <span class="math display">\[ MSE = \dfrac{1}{50} \sum_{i=1}^{50} (y_i - \hat{y}_i)^2 \]</span></li>
</ol>
<details>
<summary>
Voir le code
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>MSE_complet <span class="ot">&lt;-</span> <span class="fu">mean</span>((pred_complet<span class="sc">-</span>cosmetics<span class="sc">$</span>user_rating)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>MSE_reduit <span class="ot">&lt;-</span> <span class="fu">mean</span>((pred_reduit<span class="sc">-</span>cosmetics<span class="sc">$</span>user_rating)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>MSE_complet</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3117702</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>MSE_reduit</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3111741</code></pre>
</div>
</div>
</details>
<p>Quel modèle semble avoir la meileure performance prédictive ? Comparer avec les coefficients de détermination <span class="math inline">\(R^2\)</span> obtenus par chacun des modèles.</p>
<details class="mydetails">
<summary>
Réponse
</summary>
<p>Avec un <span class="math inline">\(MSE\)</span> inférieur, le modèle réduit réalise moins d’erreur sur la prédiction de nouvelles données. Le coefficient de détermination <span class="math inline">\(R^2\)</span> de ce modèle est pourtant plus petit que celui du modèle complet.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_cosmetics_reduit)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = user_rating ~ product_type + viscosity + pH, data = cosmetics)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.82786 -0.21084  0.00943  0.19225  0.93313 

Coefficients:
                     Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         3.9425852  0.4315259   9.136  &lt; 2e-16 ***
product_typegel     0.0958744  0.1874004   0.512   0.6092    
product_typelotion  0.0253044  0.1573501   0.161   0.8723    
product_typeserum   0.0069341  0.2013920   0.034   0.9725    
viscosity           0.0002835  0.0000722   3.926 9.87e-05 ***
pH                 -0.1661681  0.0649299  -2.559   0.0108 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2914 on 494 degrees of freedom
Multiple R-squared:  0.5914,    Adjusted R-squared:  0.5873 
F-statistic:   143 on 5 and 494 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</details>
</section>
<section id="exercice-2" class="level1 unnumbered">
<h1 class="unnumbered">Exercice 2</h1>
<p>On considère ici les données présentées dans les <a href="https://guillaumefranchi.github.io/EC651/Cours/Cours.pdf" target="_blank">slides de cours</a> sur le rendement de 80 champs de tomates, disponibles <a href="./champs_tomates.csv" download=""> ici </a>.</p>
<ol type="1">
<li>Importer les données dans R et effectuer un rapide résumé statistique. Représenter par un graphique simple les données.</li>
</ol>
<details>
<summary>
Voir le code
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>champs_tomates <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"champs_tomates.csv"</span>,<span class="at">row.names=</span><span class="dv">1</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(champs_tomates)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="TD2_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</details>
<ol start="2" type="1">
<li>Ajuster un modèle linéaire aux données. Quel est le pourcentage de variance expliquée par le modèle ?</li>
</ol>
<details>
<summary>
Voir le code
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>lm_tomates <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>champs_tomates,<span class="at">formula =</span> Rendement<span class="sc">~</span>.)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_tomates)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Rendement ~ ., data = champs_tomates)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.249633 -0.046002 -0.000089  0.061775  0.233529 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    2.1283588  0.2857600   7.448 1.42e-10 ***
Engrais        0.0013818  0.0004776   2.894 0.005001 ** 
Irrigation     0.0082729  0.0040953   2.020 0.046994 *  
Heures_Travail 0.0021900  0.0031519   0.695 0.489337    
Qualite_Sol    0.0041781  0.0011842   3.528 0.000723 ***
Temperature    0.0180394  0.0115351   1.564 0.122114    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1016 on 74 degrees of freedom
Multiple R-squared:  0.3499,    Adjusted R-squared:  0.306 
F-statistic: 7.965 on 5 and 74 DF,  p-value: 4.767e-06</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Le modèle explique 34,99% de la variance.</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<ol start="3" type="1">
<li>Quels coefficients de la régression ne semblent pas significatifs ? Préciser la statistique de test utilisée.</li>
</ol>
<details class="mydetails">
<summary>
Réponse
</summary>
<p>Pour chaque coefficient <span class="math inline">\(\beta_i\)</span>, on effectue le test <span class="math display">\[H_0 : \beta_i = 0 \quad \text{contre} \quad H_1 : \beta_i \neq0.\]</span> Sous <span class="math inline">\(H_0\)</span>, on a <span class="math inline">\(t_i = \dfrac{\hat{\beta}_i}{\hat{\sigma}_i} \sim \mathcal{T}_{n-p}\)</span>, où <span class="math inline">\(p\)</span> est le nombre de paramètres à estimer. On rejette <span class="math inline">\(H_0\)</span> au seuil <span class="math inline">\(\alpha\)</span> si <span class="math inline">\(|t_i| &gt; t_{n-p}(1-\alpha/2)\)</span> le quantile d’ordre <span class="math inline">\(1-\alpha/2\)</span> de la loi <span class="math inline">\(\mathcal{T}_{n-p}\)</span>.</p>
Ici, les coefficients associés aux variables <em>Heures_Travail</em> et <em>Temperature</em> ne sont pas signifcativeùent non nuls.
</details>
<ol start="4" type="1">
<li>Réaliser un test de modèles emboîtés afin de tester la nullité simultanée de ces coefficients. Quel est la statistique de test utilisée ici ?</li>
</ol>
<details class="mydetails">
<summary>
Réponse
</summary>
<p>On teste ici <span class="math display">\[H_0 : \beta_3 = \beta_5 = 0 \quad \text{contre} \quad H_1: \beta_3\neq 0 \ \text{ou} \ \beta_5 \neq 0. \]</span> Sous <span class="math inline">\(H_0\)</span>, la statistique de test <span class="math display">\[ F = \dfrac{n-p}{2}\times \dfrac{SCR_0-SCR}{SCR}\]</span> suit la loi de Fisher <span class="math inline">\(\mathcal{F}_{n-p}^2\)</span>, où</p>
<ul>
<li><span class="math inline">\(SCR\)</span> est la somme des carrés résiduelle quand on prend toutes les variables dans le modèle;</li>
<li><span class="math inline">\(SCR_0\)</span> est la somme des carrés résiduelles quand on ne prend pas les variables <em>Heures_Travail</em> et <em>Temperature</em> dans le modèle.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>lm_tomates_reduit <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>champs_tomates,<span class="at">formula =</span> Rendement<span class="sc">~</span>Engrais <span class="sc">+</span> Irrigation <span class="sc">+</span> Qualite_Sol)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lm_tomates,lm_tomates_reduit)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: Rendement ~ Engrais + Irrigation + Heures_Travail + Qualite_Sol + 
    Temperature
Model 2: Rendement ~ Engrais + Irrigation + Qualite_Sol
  Res.Df     RSS Df Sum of Sq      F Pr(&gt;F)
1     74 0.76409                           
2     76 0.79376 -2 -0.029669 1.4367 0.2443</code></pre>
</div>
</div>
Ici, on ne rejette pas l’hypothèse nulle <em>(<span class="math inline">\(p\)</span>-value égale à 0.2443)</em>.
</details>
<ol start="5" type="1">
<li>Comme dans l’exercice précédent, on souhaite comparer la capacité prédictive des deux modèles construits.</li>
</ol>
<p>Pour ce faire, on propose d’utiliser une validation croisée 10 blocs. Le principe est de séparer aléatoirement le jeu de données en 10 blocs de 8 observations, et d’ajuster 10 fois le modèle linéaire avec les variables retenues. Pour chacun des 10 ajustements :</p>
<ul>
<li>9 blocs (72 observations) servent à entraîner le modèle;</li>
<li>1 bloc (8 observations) sert à prédire les nouvelles valeurs, et calculer le <span class="math inline">\(MSE\)</span> sur 8 valeurs;</li>
<li>on estime enfin le risque quadratique du modèle en calculant la moyenne des 10 <span class="math inline">\(MSE\)</span> calculés.</li>
</ul>
<p>On présente ci-dessous un code utilisant le package <code>tidymodels</code> permettant d’effectuer cette validation croisée pour le modèle complet.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Création des 10 blocs</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(<span class="at">data=</span>df_tomato,<span class="at">v =</span> <span class="dv">10</span>) </span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Spécification du modèle linéaire utilisé</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>lm_spec <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>(<span class="at">mode=</span><span class="st">"regression"</span>,<span class="at">engine=</span><span class="st">"lm"</span>)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Précision du modèle utilisé dans un workflow</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>lm_workflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> <span class="fu">add_model</span>(lm_spec) <span class="sc">%&gt;%</span> <span class="fu">add_formula</span>(Rendement<span class="sc">~</span>.)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustement du modèle pour chaque bloc</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>lm_cv <span class="ot">&lt;-</span> lm_workflow <span class="sc">%&gt;%</span> <span class="fu">fit_resamples</span>(<span class="at">resamples =</span> folds)</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Récupération des métriques d'évaluation obtenues par validation croisée</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>metrics_lm_cv <span class="ot">&lt;-</span> <span class="fu">collect_metrics</span>(lm_cv)</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>metrics_lm_cv</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Adapter ce code au problème de l’exercice, et comparer les performances prédictives du modèle complet et du modèle réduit.</p>
<details class="mydetails">
<summary>
Réponse
</summary>
<p>On effectue une validation croisée pour chaque modèle. Pour le modèle complet, on a :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Création des 10 blocs</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(<span class="at">data=</span>champs_tomates,<span class="at">v =</span> <span class="dv">10</span>) </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Spécification du modèle linéaire utilisé</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>lm_spec <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>(<span class="at">mode=</span><span class="st">"regression"</span>,<span class="at">engine=</span><span class="st">"lm"</span>)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Précision du modèle utilisé dans un workflow</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>lm_workflow_complet <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> <span class="fu">add_model</span>(lm_spec) <span class="sc">%&gt;%</span> <span class="fu">add_formula</span>(Rendement<span class="sc">~</span>.)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustement du modèle pour chaque bloc</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>lm_cv_complet <span class="ot">&lt;-</span> lm_workflow_complet <span class="sc">%&gt;%</span> <span class="fu">fit_resamples</span>(<span class="at">resamples =</span> folds)</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Récupération des métriques d'évaluation obtenues par validation croisée</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>metrics_lm_cv_complet <span class="ot">&lt;-</span> <span class="fu">collect_metrics</span>(lm_cv_complet)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Et pour le modèle réduit :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Précision du modèle utilisé dans un workflow</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>lm_workflow_reduit <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> <span class="fu">add_model</span>(lm_spec) <span class="sc">%&gt;%</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_formula</span>(Rendement<span class="sc">~</span>Engrais <span class="sc">+</span> Irrigation <span class="sc">+</span> Qualite_Sol)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustement du modèle pour chaque bloc</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>lm_cv_reduit <span class="ot">&lt;-</span> lm_workflow_reduit <span class="sc">%&gt;%</span> <span class="fu">fit_resamples</span>(<span class="at">resamples =</span> folds)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Récupération des métriques d'évaluation obtenues par validation croisée</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>metrics_lm_cv_reduit <span class="ot">&lt;-</span> <span class="fu">collect_metrics</span>(lm_cv_reduit)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>On compare ensuite les <span class="math inline">\(RMSE\)</span>, qui sont les racines carrées des <span class="math inline">\(MSE\)</span> définis plus haut.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>metrics_lm_cv_complet</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 6
  .metric .estimator   mean     n std_err .config        
  &lt;chr&gt;   &lt;chr&gt;       &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;          
1 rmse    standard   0.0990    10  0.0120 pre0_mod0_post0
2 rsq     standard   0.416     10  0.0783 pre0_mod0_post0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>metrics_lm_cv_reduit</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 6
  .metric .estimator   mean     n std_err .config        
  &lt;chr&gt;   &lt;chr&gt;       &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;          
1 rmse    standard   0.0983    10  0.0118 pre0_mod0_post0
2 rsq     standard   0.412     10  0.0807 pre0_mod0_post0</code></pre>
</div>
</div>
Le modèle réduit semble ainsi légèrement plus performant que le modèle complet pour effectuer des pévisions.
</details>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copié");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copié");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>