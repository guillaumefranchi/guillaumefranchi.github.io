[
  {
    "objectID": "TD3.html",
    "href": "TD3.html",
    "title": "TD3 : Régression non linéaire",
    "section": "",
    "text": "Exercice 1\nOn considère le jeu de données azote_ble.csv disponible  ici .\nOn a recensé ici le rendement (en T/ha) de 92 champs de blés en fonction de la dose d’azote apportée (en kg/ha).\n\nImporter les données dans R, et en faire un bref résumé statistique.\nUn modèle linéaire semble-t-il adapté afin d’expliquer le rendement des champs ?\nOn se propose de modéliser le rendement des champs par un modèle polynomial de degré 3 :\n\n\\[ Y = \\beta_0 + \\beta_1 X + \\beta_2 X^2 + \\beta_3 X^3 +\\beta_4X^4+ \\varepsilon\\] où :\n\n\\(X\\) désigne la dose d’azote apportée (en kg/ha);\n\\(Y\\) désigne le rendement du champ (en T/ha);\n\\(\\varepsilon \\sim \\mathcal{N}(0,\\sigma^2)\\) désigne un bruit gausssien.\n\nModifier le jeu de données initial afin de faire apparaître les variables \\(X^2\\), \\(X^3\\) et \\(X^4\\).\n\nÀ l’aide de la fonction lm(), ajuster un modèle polynomial aux données.\nQuel est le pourcentage de variance expliquée par le modèle ? Certains coefficients semblent-ils non significatifs ?\nEffectuer un ou plusieurs tests de modèles emboîtés afin de déterminer les coefficients significativement non nuls du modèle. Quel modèle est finalement retenu ?\nTracer le nuage de points représentant les données, et y ajouter les différents intervalles de confiance au niveau 95% pour les prédictions faites par le modèle.\n\n\n\nExercice 2\nOn étudie dans cet exercice l’espérance de vie moyenne dans un pays en fonction de sa population et de son PIB par habitant. On dispose pour cela d’un jeu de données (disponible  ici ) libre de droits issu de la banque mondiale, et disponible sur Gapminder.org, CCBY License.\nOn trouvera dans ce jeu de données pour 142 pays en 2007 :\n\nle PIB par habitant;\nla population du pays;\nle continent du pays;\nl’espérance de vie dans le pays.\n\n\nImporter les données dans R et résumer brièvement les données.\nAjuster un modèle linéaire permettant d’expliquer l’espérance de vie dans un pays en fonction des autres variables. Ecrire mathématiquement ce modèle.\nQuel le pourcentage de variance expliquée par ce modèle ?\nRé-ajuster le modèle afin de ne conserver que les coefficients significativement non nuls.\nUn modèle linéaire n’est pas tout à fait adapté ici. On va utiliser un modèle non linéaire en utilisant une transformation logarithmique sur les données de PIB par habitant.\n\n\nEcrire mathématiquement le modèle considéré.\nCréer une nouvelle variable donnant le logarithme du PIB par habitant.\nReprésenter brièvement les nouvelles données obtenues.\nA l’aide de la fonction lm() ajuster le modèle envisagé aux données.\nRé-ajuster le modèle afin de ne conserver que les coefficients significativement non nuls.\n\n\nOn souhaite dorénavant comparer les deux modèles construits.\n\n\nDans un premier temps, comparer les coefficients de détermination \\(R^2\\) et \\(R_a^2\\).\nOn compare ensuite les critères \\(AIC\\) (Akaike Information Criterion) des deux modèles : \\[AIC = 2p-2\\ln(L)\\] où\n\n\n\\(p\\) désigne le nombre de paramètres à estimer dans le modèle;\n\\(L\\) désigne la vraisemblance du modèle.\n\nUn tel critère vise à pénaliser les modèles ayant trop de paramètres à estimer. Il favorise donc les modèles parcimonieux en sélectionnant le modèle avec le critère \\(AIC\\) le plus faible.\nSélectionner le modèle ayant le meilleur critère \\(AIC\\) à l’aide de la fonction AIC().\n\nOn compare dorénavant les critères \\(BIC\\) (Bayesian Information Criterion) des modèles : \\[BIC = p\\ln(n) -2\\ln(L)\\] où \\(n\\) désigne le nombre d’observations. Une nouvelle fois, le but est de choisir un modèle parcimonieux en sélectionnant le critère \\(BIC\\) le plus faible. Comparé au critère \\(AIC\\), le critère \\(BIC\\) pénalise plus fortement les modèles avec beaucoup de paramètres à estimer.\n\nSélectionner le modèle ayant le meilleur critère \\(BIC\\), à l’aide de la fonction BIC().\n\nEnfin, on compare les performances prédictives des modèles. Pour ce faire, on va estimer le risque quadratique des deux modèles par validation croisée 10 blocs (voir TD2).\n\nSélectionner le modèles semblant avoir la meilleure performance prédictive.",
    "crumbs": [
      "TD3 : Régression non linéaire"
    ]
  },
  {
    "objectID": "TD1.html",
    "href": "TD1.html",
    "title": "TD1 : Régression linéaire simple",
    "section": "",
    "text": "Exercice 1\nOn considère le jeu de données tomato_sauce.csv disponible  ici .\nLes données recueillies portent sur des mesures effectuées sur un site de production de sauce à base de tomate.\nLa variable \\(Y\\) à expliquer, notée rdt, est une réponse liée au rendement de production (% d’extrait de tomate dans la sauce).\nLa variable explicative \\(X\\), notée ratioMP, est relative à la qualité du lot de matières premières (% de solides insolubles dans l’eau par rapport à la quantité de solide totale).\n24 observations ont été réalisées sur une série d’ordres de production consécutifs\n\nImporter les données dans R, et en dresser un rapide résumé statistique.\nRéaliser les boxplots et histogrammes des différentes variables. Commenter.\nTracer le nuage de points associé aux données, puis calculer le coefficient de corrélation linéaire entre les deux variables (rappeler la définition de ce dernier).\n\nCelui-ci est-il significativement non nul ? Un modèle linéaire semble-t-il adapté aux données ? Ecrire mathématiquement ce modèle.\n\nÀ l’aide de la fonction lm(), ajsuter un modèle linéaire aux données. En faire un résumé rapide avec la fonction summary().\nDonner les valeurs estimées des coefficients du modèle, ainsi qu’un intervalle de confiance à 95% de ces coefficients avec la fonction confint(). Ceux-ci sont-ils significativement non nuls ? Préciser la statistique de test utilisée ici.\nQuelle est la proportion de variance expliquée par le modèle ? Rappeler la définition de l’indicateur statistique utilisé.\nUtiliser la fonction geom_smooth() du package ggplot2 afin de tracer la droite de régression linéaire ajustée aux données.\n\nL’intervalle de confiance à 95% tracé par cette fonction est celui de la valeur \\(\\hat{\\beta}_0 + \\hat{\\beta}_1 x\\). Il s’agit en fait de l’intervalle de confiance pour la valeur moyenne de la variable réponse \\(y\\).\n\nOn souhaite à présent rajouter l’intervalle de confiance pour les prévisions faites par le modèle. Celui-ci est différent de l’intervalle tracé par la fonction geom_smooth(). Il prend notamment en compte la dispersion liée au bruit gaussien du modèle.\n\n\nA l’aide de la fonction predict() récupérer les bornes inférieures et supérieures des prévisions associées aux observations du jeu de données. On stockera ces valeurs dans le data-frame initial avec pour noms de variables pred_lwr et pred_upr.\nRajouter, à l’aide de la fonction geom_line(), ces bornes sur le graphique réalisé jusqu’à présent.\n\n\nDéterminer les valeurs prédites (ainsi que leurs intervalles de confiance à 95%) de la variable rendement pour les valeurs suivantes de la variable ratioMP.\n\n\n\nExercice 2\nOn s’intéresse ici à l’équilibre des saveurs dans différents cidres.\n90 cidres bruts ont été évalués par un jury sensoriel formé de 24 juges (échelle de notation de 1 à 10, calcul des notes moyennes), selon différents critères :\n\nSaveur sucrée;\nSaveur Acide;\nSaveur amère;\nSaveur astringente\n\nOn étudie plus précisément la relation entre la saveur astringente (variable réponse) des cidres et leur saveur amère (variable explicative).\n\nImporter le jeu de données dans R (disponible  ici ), et en dresser un rapide résumé statistique.\nReprésenter graphiquement la distribution des différentes variables du jeu de données par la méthode de votre choix.\nCombien de données manquantes le jeu de données comporte-t-il ?\nOn souhaite imputer ces valeurs manquantes via un modèle linéaire simple reliant la saveur astringente (variable réponse) des cidre et leur saveur amère (variable explicative).\n\nUn tel modèle vous semble-t-il adapté ?\n\nAjuster un modèle linéaire donnant la saveur astringente en fonction de la saveur amère. Quel est le pourcentage de variance expliquée par ce modèle ?\nSur un graphique, représenter :\n\n\nle nuage de points donnant la saveur astringente des cidres en fonction de leur saveur amère;\nla droite de régression linéaire donnée par le modèle utilisé;\nles différents intervalles de confiance au niveau 95% pour les prévisions faites par le modèle.\n\n\nImputer enfin les valeurs manquantes, et donner leur intervalle de confiance au niveau 95%.",
    "crumbs": [
      "TD1 : Régression linéaire simple"
    ]
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "EC651 et 56/53 : Modélisation statistique (Régression linéaire)",
    "section": "",
    "text": "Avant-Propos\nCe notebook contient les exercices liés à la première partie du cours de modélisation statistique, concernant la régression linéaire.\nVous trouverez, sur la barre de navigation à gauche, le menu vous permettant d’accéder aux différents TDs.\nVous trouverez ci-dessous des liens utiles pour ce cours et ces TDS :\n\nLes slides de cours;\nLe polycopié d’Arnaud Guyader;\nLe lien vers le site du livre R pour la statistique et la science des données, sous la direction de F.Husson.",
    "crumbs": [
      "Avant-Propos"
    ]
  },
  {
    "objectID": "TD2.html",
    "href": "TD2.html",
    "title": "TD2 : Régression linéaire multiple",
    "section": "",
    "text": "Exercice 1\nOn considère un échantillon de 500 produits anti-âge disponible  ici .\nLe jeu de données consiste en 6 variables :\n\nproduct_type,\nviscosity en mPa.s,\npH,\ndensity en g/cm\\(^3\\),\nsurface_tension en mN/m,\nuser_rating, correspondant à une note moyenne donnée par les consommateurs (entre 1 et 5).\n\nOn cherche à expliquer la note donnée par les consommateurs en fonction des autres variables.\n\nImporter les données dans R et effectuer un rapide résumé statistique.\nReprésenter graphiquement les liens pouvant exister entre la variable user_rating et les autres.\nUn modèle linéaire semble-t-il adapté pour prédire la note donnée par les consommateurs ? Ecrire mathématiquement ce modèle.\nAjuster un modèle linéaire aux données, permettant d’expliquer user_rating en fonction des autres variables.\n\nQuel est le pourcentage de variance expliquée par le modèle ?\nQuelles variables ne semblent pas expliquer la note donnée par les consommateurs ?\n\nÀ l’aide de la fonction anova(), réaliser un test de modèles emboîtés afin de déterminer les variables intervenant réellement dans le modèle. Ecrire les hypothèses envisagées dans ce test.\nOn souhaite maintenant comparer les performances prédictitives des deux modèles utilisés précédemment :\n\n\nle modèle complet, avec toutes les variables;\nle modèle réduit, comprenant uniquement les variables semblant expliquer la note donnée par les consommateurs.\n\nPour ce faire, on dispose de 50 données supplémentaires (disponibles  ici ).\nPrédire, avec les deux modèles, les notes données par les consommateurs pour ces 50 nouveaux produits.\n\nCalculer, pour chacune des prédictions, l’erreur quadratique moyenne \\(MSE\\) réalisée par chaque modèle : \\[ MSE = \\sum_{i=1}^{50} (y_i - \\hat{y}_i)^2 \\]\n\nQuel modèle semble avoir la meileure performance prédictive ? Comparer avec les coefficients de détermination \\(R^2\\) obtenus par chacun des modèles.\n\n\nExercice 2\nOn considère ici les données présentées dans les slides de cours sur le rendement de 80 champs de tomates, disponibles  ici .\n\nImporter les données dans R et effectuer un rapide résumé statistique. Représenter par un graphique simple les données.\nAjuster un modèle linéaire aux données. Quel est le pourcentage de variance expliquée par le modèle ?\nQuels coefficients de la régression ne semblent pas significatifs ? Préciser la statistique de test utilisée.\nRéaliser un test de modèles emboîtés afin de tester la nullité simultanée de ces coefficients. Quel est la statistique de test utilisée ici ?\nComme dans l’exercice précédent, on souhaite comparer la capacité prédictive des deux modèles construits.\n\nPour ce faire, on propose d’utiliser une validation croisée 10 blocs. Le principe est de séparer aléatoirement le jeu de données en 10 blocs de 8 observations, et d’ajuster 10 fois le modèle linéaire avec les variables retenues. Pour chacun des 10 ajustements :\n\n9 blocs (72 observations) servent à entraîner le modèle;\n1 bloc (8 observations) sert à prédire les nouvelles valeurs, et calculer le \\(MSE\\) sur 8 valeurs;\non estime enfin le risque quadratique du modèle en calculant la moyenne des 10 \\(MSE\\) calculés.\n\nOn présente ci-dessous un code utilisant le package tidymodels permettant d’effectuer cette validation croisée pour le modèle complet.\n\nlibrary(tidymodels)\nset.seed(42)\n\n# Création des 10 blocs\nfolds &lt;- vfold_cv(data=df_tomato,v = 10) \n\n# Spécification du modèle linéaire utilisé\nlm_spec &lt;- linear_reg(mode=\"regression\",engine=\"lm\")\n\n# Précision du modèle utilisé dans un workflow\nlm_workflow &lt;- workflow() %&gt;% add_model(lm_spec) %&gt;% add_formula(Rendement~.)\n\n# Ajustement du modèle pour chaque bloc\nlm_cv &lt;- lm_workflow %&gt;% fit_resamples(resamples = folds)\n\n# Récupération des métriques d'évaluation obtenues par validation croisée\nmetrics_lm_cv &lt;- collect_metrics(lm_cv)\nmetrics_lm_cv\n\nAdapter ce code au problème de l’exercice, et comparer les performances prédictives du modèle complet et du modèle réduit.",
    "crumbs": [
      "TD2 : Régression linéaire multiple"
    ]
  }
]